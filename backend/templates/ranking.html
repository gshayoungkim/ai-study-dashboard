{% extends "base.html" %}
{% block title %}ë­í‚¹{% endblock %}
{% block content %}
<div class="ranking-page">
    <div class="page-header">
        <h1>ğŸ† ì¢…í•© ë­í‚¹</h1>
        <p class="subtitle">ì—´ì‹¬íˆ ê³µë¶€í•˜ëŠ” ìŠ¤í„°ë””ì›ë“¤ì˜ ìˆœìœ„ë¥¼ í™•ì¸í•˜ì„¸ìš”!</p>
    </div>
    

    
    <div class="podium-section">
    {% if top_ranks %}
    <div class="podium">
        <!-- 2ë“± -->
        {% if 2 in top_ranks %}
        <div class="podium-place second">
            <div class="medal">ğŸ¥ˆ</div>
            {% for player in top_ranks[2] %}
            <div class="player-name">{{ player.name }}</div>
            {% endfor %}
            {% set first_player = top_ranks[2][0] %}
            <div class="player-level" style="color: {{ first_player.level_color }}">{{ first_player.level }}</div>
            <div class="player-badges">
                {% for badge in first_player.badges[:3] %}
                    <span class="badge-mini" title="{{ badge.name }}">{{ badge.icon }}</span>
                {% endfor %}
            </div>
            <div class="player-score">{{ first_player.total_score }}ì </div>
            <div class="podium-box">2nd</div>
        </div>
        {% endif %}
        
        <!-- 1ë“± -->
        {% if 1 in top_ranks %}
        <div class="podium-place first">
            <div class="medal">ğŸ¥‡</div>
            {% for player in top_ranks[1] %}
            <div class="player-name">{{ player.name }}</div>
            {% endfor %}
            {% set first_player = top_ranks[1][0] %}
            <div class="player-level" style="color: {{ first_player.level_color }}">{{ first_player.level }}</div>
            <div class="player-badges">
                {% for badge in first_player.badges[:3] %}
                    <span class="badge-mini" title="{{ badge.name }}">{{ badge.icon }}</span>
                {% endfor %}
            </div>
            <div class="player-score">{{ first_player.total_score }}ì </div>
            <div class="podium-box champion">1st</div>
        </div>
        {% endif %}
        
        <!-- 3ë“± -->
        {% if 3 in top_ranks %}
        <div class="podium-place third">
            <div class="medal">ğŸ¥‰</div>
            {% for player in top_ranks[3] %}
            <div class="player-name">{{ player.name }}</div>
            {% endfor %}
            {% set first_player = top_ranks[3][0] %}
            <div class="player-level" style="color: {{ first_player.level_color }}">{{ first_player.level }}</div>
            <div class="player-badges">
                {% for badge in first_player.badges[:3] %}
                    <span class="badge-mini" title="{{ badge.name }}">{{ badge.icon }}</span>
                {% endfor %}
            </div>
            <div class="player-score">{{ first_player.total_score }}ì </div>
            <div class="podium-box">3rd</div>
        </div>
        {% endif %}
    </div>
    {% endif %}
</div>
    
    <!-- ì „ì²´ ë­í‚¹ í…Œì´ë¸” -->
    <div class="ranking-table-section">
        <h2>ğŸ“Š ì „ì²´ ë­í‚¹</h2>
        <div class="ranking-table-wrapper">
            <table class="ranking-table">
                <thead>
                    <tr>
                        <th>ìˆœìœ„</th>
                        <th>ì´ë¦„</th>
                        <th>ë ˆë²¨</th>
                        <th>ì´ì </th>
                        <th>ì±•í„°</th>
                        <th>í€´ì¦ˆ</th>
                        <th>ë…¼ë¬¸</th>
                        <th>ë±ƒì§€</th>
                    </tr>
                </thead>
                <tbody>
                    {% for rank_data in rankings %}
                    <tr class="rank-row {% if loop.index <= 3 %}top-three{% endif %}">
                        <td class="rank-cell">
                            {% if rank_data.rank == 1 %}
                                <span class="rank-icon gold">ğŸ¥‡</span>
                            {% elif rank_data.rank == 2 %}
                                <span class="rank-icon silver">ğŸ¥ˆ</span>
                            {% elif rank_data.rank == 3 %}
                                <span class="rank-icon bronze">ğŸ¥‰</span>
                            {% else %}
                                <span class="rank-number">{{ rank_data.rank }}</span>
                            {% endif %}
                        </td>
                        <td class="name-cell">
                            <strong>{{ rank_data.name }}</strong>
                        </td>
                        <td class="level-cell" style="color: {{ rank_data.level_color }}">
                            {{ rank_data.level }}
                        </td>
                        <td class="score-cell">
                            <span class="total-score">{{ rank_data.total_score }}</span>ì 
                        </td>
                        <td>
                            <span class="score-detail">{{ rank_data.chapters_completed }}/10</span>
                            <span class="score-points">({{ rank_data.chapter_score }}ì )</span>
                        </td>
                        <td>
                            <span class="score-detail">{{ rank_data.quiz_count }}ê°œ</span>
                            <span class="score-points">({{ rank_data.quiz_score }}ì )</span>
                        </td>
                        <td>
                            <span class="score-detail">{{ rank_data.paper_count }}ê°œ</span>
                            <span class="score-points">({{ rank_data.paper_score }}ì )</span>
                        </td>
                        <td class="badges-cell">
                            {% for badge in rank_data.badges %}
                                <span class="badge-item" title="{{ badge.name }}">
                                    <span class="badge-icon-table">{{ badge.icon }}</span>
                                    <span class="badge-text">{{ badge.name }}</span>
                                </span>
                            {% endfor %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

<div class="badge-level-section">
  <!-- ì™¼ìª½: ë±ƒì§€ -->
  <div class="badge-level-col">
    <h2 class="badge-title-main">ğŸ–ï¸ ë±ƒì§€ ì‹œìŠ¤í…œ</h2>
    <div class="badge-block badge-bg1">
      <span class="badge-icon">ğŸ¥‡</span>
      <span class="badge-title"><b>ê³¨ë“œ ëŸ¬ë„ˆ</b></span>
      <span class="badge-desc">6ì±•í„° ì´ìƒ ì™„ë£Œ</span>
    </div>
    <div class="badge-block badge-bg2">
      <span class="badge-icon">ğŸ”¥</span>
      <span class="badge-title"><b>ë¶ˆê½ƒ í•™ìŠµì</b></span>
      <span class="badge-desc">3ì±•í„° ì´ìƒ ì™„ë£Œ</span>
    </div>
    <div class="badge-block badge-bg3">
      <span class="badge-icon">ğŸ’</span>
      <span class="badge-title"><b>ì™„ë²½ì£¼ì˜ì</b></span>
      <span class="badge-desc">ì „ì²´ ì±•í„° ì™„ë£Œ</span>
    </div>
    <div class="badge-block badge-bg4">
      <span class="badge-icon">ğŸ¯</span>
      <span class="badge-title"><b>í€´ì¦ˆ ë§ˆìŠ¤í„°</b></span>
      <span class="badge-desc">í€´ì¦ˆ 10ê°œ ì´ìƒ ì™„ë£Œ</span>
    </div>
    <div class="badge-block badge-bg5">
      <span class="badge-icon">ğŸ“š</span>
      <span class="badge-title"><b>ë¶ì›œ</b></span>
      <span class="badge-desc">ë…¼ë¬¸ ê³µìœ  5íšŒ ì´ìƒ</span>
    </div>
  </div>
  <!-- ì˜¤ë¥¸ìª½: ë ˆë²¨ -->
  <div class="badge-level-col">
    <h2 class="badge-title-main">ğŸ… ë ˆë²¨ êµ¬ê°„ ì•ˆë‚´</h2>
    <div class="badge-block badge-bg1">
      <span class="badge-icon">ğŸ†</span>
      <span class="badge-title"><b>ê·¸ëœë“œ ë§ˆìŠ¤í„°</b></span>
      <span class="badge-desc">150ì  ì´ìƒ<br>
        <span class="desc-sub">ìŠ¤í„°ë””, í€´ì¦ˆ, ë…¼ë¬¸ ëª¨ë‘ ì™„ë²½ ë§ˆìŠ¤í„°</span>
      </span>
    </div>
    <div class="badge-block badge-bg2">
      <span class="badge-icon">ğŸ’</span>
      <span class="badge-title"><b>ë§ˆìŠ¤í„°</b></span>
      <span class="badge-desc">100ì  ì´ìƒ<br>
        <span class="desc-sub">ìƒìœ„ê¶Œ ì‹¤ë ¥ì</span>
      </span>
    </div>
    <div class="badge-block badge-bg3">
      <span class="badge-icon">â­</span>
      <span class="badge-title"><b>ì „ë¬¸ê°€</b></span>
      <span class="badge-desc">70ì  ì´ìƒ<br>
        <span class="desc-sub">ê¾¸ì¤€í•œ í•™ìŠµì</span>
      </span>
    </div>
    <div class="badge-block badge-bg4">
      <span class="badge-icon">ğŸ”¥</span>
      <span class="badge-title"><b>ì—´ì •ì ì¸ í•™ìŠµì</b></span>
      <span class="badge-desc">40ì  ì´ìƒ<br>
        <span class="desc-sub">ì„±ì¥í•˜ëŠ” ì—´ì •ëŸ¬</span>
      </span>
    </div>
    <div class="badge-block badge-bg5">
      <span class="badge-icon">ğŸŒ±</span>
      <span class="badge-title"><b>ì´ˆë³´ í•™ìŠµì</b></span>
      <span class="badge-desc">ê·¸ ì™¸<br>
        <span class="desc-sub">í•™ìŠµì„ ì´ì œ ì‹œì‘!</span>
      </span>
    </div>
  </div>
</div>

    <!-- ì ìˆ˜ ê³„ì‚° ì„¤ëª… -->
    <div class="score-info">
        <h3>ğŸ“ ì ìˆ˜ ê³„ì‚° ë°©ì‹</h3>
        <div class="score-rules">
            <div class="rule-item">
                <span class="rule-icon">ğŸ“š</span>
                <span class="rule-text">ì±•í„° ì™„ë£Œ: <strong>10ì </strong></span>
            </div>
            <div class="rule-item">
                <span class="rule-icon">ğŸ¯</span>
                <span class="rule-text">í€´ì¦ˆ ì™„ë£Œ: <strong>5ì </strong></span>
            </div>
            <div class="rule-item">
                <span class="rule-icon">ğŸ“„</span>
                <span class="rule-text">ë…¼ë¬¸ ê³µìœ : <strong>2ì </strong></span>
            </div>
        </div>
    </div>
</div>

<style>
.ranking-page {
    padding: 2rem;
    background: #f5f5f5;
    min-height: 100vh;
}

.page-header {
    text-align: center;
    margin-bottom: 3rem;
}

.page-header h1 {
    font-size: 2.5rem;
    color: #333;
    margin-bottom: 0.5rem;
}

.subtitle {
    color: #666;
    font-size: 1.1rem;
}

/* ë±ƒì§€ ì„¤ëª… ì„¹ì…˜ */
.badge-level-section {
  display: flex;
  justify-content: center;
  gap: 32px;
  max-width: 950px;
  margin: 0 auto 2.5rem auto;
  padding: 2.4rem 2vw;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 2px 14px rgba(100,126,234,0.08);
}
.badge-level-col {
  flex: 1 1 0;
  min-width: 230px;
}
.badge-title-main {
  font-size: 1.15rem;
  color: #667eea;
  margin-bottom: 2.1rem;
  font-weight: 700;
  letter-spacing: -0.5px;
}
.badge-block {
  display: flex;
  align-items: center;
  gap: 1.1rem;
  padding: 1.25rem 1.4rem;
  margin-bottom: 1.1rem;
  border-radius: 13px;
  background: #f7f9ff;
  box-shadow: 0 1px 5px rgba(102,126,234,0.06);
}
.badge-block .badge-icon {
  font-size: 1.9rem;
  flex-shrink: 0;
}
.badge-block .badge-title {
  font-size: 0.99rem;
  font-weight: 700;
  margin-right: 0.7rem;
  min-width: 85px;
}
.badge-block .badge-desc {
  font-size: 0.9rem;
  color: #444b5e;
  line-height: 1.3;
}
.badge-block .desc-sub {
  font-size: 0.8rem;
  color: #aaa;
  font-weight: 400;
}
.badge-bg1 { background: #f1f7fe; }
.badge-bg2 { background: #fdf6f2; }
.badge-bg3 { background: #f4f8f5; }
.badge-bg4 { background: #fff4ed; }
.badge-bg5 { background: #f4faff; }
@media (max-width: 900px) {
  .badge-level-section { flex-direction: column; padding: 1.2rem 2vw; }
  .badge-level-col { margin-bottom: 1.5rem; }
}
/* í¬ë””ì›€ ìŠ¤íƒ€ì¼ */
.podium-section {
    max-width: 900px;
    margin: 0 auto 3rem;
}

.podium {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    gap: 1rem;
}

.podium-place {
    flex: 1;
    max-width: 250px;
    text-align: center;
    position: relative;
}

.medal {
    font-size: 4rem;
    margin-bottom: 0.5rem;
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-20px); }
    60% { transform: translateY(-10px); }
}

.player-name {
    font-size: 1.1rem;  /* ë™ì ì ì—¬ëŸ¬ëª…ì¼ ê²½ìš° ì‘ê²Œ */
    font-weight: bold;
    color: #333;
    margin-bottom: 0.2rem;
}

.player-level {
    font-size: 0.9rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.player-badges {
    display: flex;
    justify-content: center;
    gap: 0.3rem;
    margin-bottom: 0.5rem;
}

.badge-mini {
    font-size: 1.5rem;
}

.player-score {
    font-size: 1.5rem;
    font-weight: bold;
    color: #667eea;
    margin-bottom: 1rem;
}

.podium-box {
    padding: 2rem 1rem;
    background: #e0e0e0;
    border-radius: 8px 8px 0 0;
    font-size: 1.5rem;
    font-weight: bold;
    color: white;
}

.first .podium-box {
    height: 200px;
    background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 8px 20px rgba(255, 215, 0, 0.4);
}

.second .podium-box {
    height: 150px;
    background: linear-gradient(135deg, #C0C0C0 0%, #A8A8A8 100%);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 1rem;
}

.third .podium-box {
    height: 120px;
    background: linear-gradient(135deg, #CD7F32 0%, #B87333 100%);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding-bottom: 1rem;
}

/* ë­í‚¹ í…Œì´ë¸” */
.ranking-table-section {
    max-width: 1200px;
    margin: 0 auto 2rem;
    background: white;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.1);
}

.ranking-table-section h2 {
    color: #667eea;
    margin-bottom: 1.5rem;
}

.ranking-table-wrapper {
    overflow-x: auto;
}

.ranking-table {
    width: 100%;
    border-collapse: collapse;
}

.ranking-table thead {
    background: #f8f9fa;
}

.ranking-table th {
    padding: 1rem;
    text-align: left;
    font-weight: bold;
    color: #333;
    border-bottom: 2px solid #e0e0e0;
}

.ranking-table td {
    padding: 1rem;
    border-bottom: 1px solid #f0f0f0;
}

.rank-row {
    transition: all 0.3s;
}

.rank-row:hover {
    background: #f8f9fa;
}

.top-three {
    background: linear-gradient(90deg, rgba(102, 126, 234, 0.1) 0%, transparent 100%);
}

.rank-cell {
    text-align: center;
    font-size: 1.5rem;
}

.rank-icon {
    font-size: 2rem;
}

.rank-number {
    font-size: 1.2rem;
    font-weight: bold;
    color: #666;
}

.name-cell {
    font-size: 1.1rem;
}

.level-cell {
    font-size: 0.9rem;
    font-weight: bold;
}

.score-cell {
    font-weight: bold;
    color: #667eea;
}

.total-score {
    font-size: 1.2rem;
}

.score-detail {
    font-weight: bold;
}

.score-points {
    font-size: 0.85rem;
    color: #999;
    margin-left: 0.3rem;
}

.badges-cell {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.badge-item {
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    padding: 0.3rem 0.6rem;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 6px;
    font-size: 0.85rem;
    transition: all 0.3s;
}

.badge-item:hover {
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.badge-icon-table {
    font-size: 1.2rem;
}

.badge-text {
    font-weight: 500;
    color: #666;
}

/* ì ìˆ˜ ê³„ì‚° ì„¤ëª… */
.score-info {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.1);
}

.score-info h3 {
    color: #667eea;
    margin-bottom: 1.5rem;
}

.score-rules {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.rule-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem;
    background: #f8f9fa;
    border-radius: 8px;
}

.rule-icon {
    font-size: 2rem;
}

.rule-text {
    font-size: 1rem;
    color: #666;
}

@media (max-width: 768px) {
    .badge-grid {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }
    
    .podium {
        flex-direction: column;
        align-items: center;
    }
    
    .podium-place {
        max-width: 100%;
    }
    
    .ranking-table {
        font-size: 0.9rem;
    }
    
    .badge-text {
        display: none;
    }
}
</style>
{% endblock %}
